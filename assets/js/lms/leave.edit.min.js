var last_startDate=moment("Jan 1, 1970"),last_endDate=moment("Jan 1, 1970"),duration=0,last_duration=0,addDays=0,last_type=0;
function getLeaveLength(){var a=moment($("#startdate").val()),d=moment($("#enddate").val()),b=$("#startdatetype option:selected").val(),c=$("#enddatetype option:selected").val();a.isValid()&&d.isValid()&&(a.isSame(d)?(addDays=0,"Morning"==b&&"Morning"==c&&(duration=.5,$("#spnDayOff").html("<img src='"+baseURL+"assets/images/leave_1d_MM.png' />")),"Afternoon"==b&&"Afternoon"==c&&(duration=.5,$("#spnDayOff").html("<img src='"+baseURL+"assets/images/leave_1d_AA.png' />")),"Morning"==b&&"Afternoon"==
c&&(duration=1,$("#spnDayOff").html("<img src='"+baseURL+"assets/images/leave_1d_MA.png' />")),"Afternoon"==b&&"Morning"==c&&$("#spnDayOff").html("<img src='"+baseURL+"assets/images/date_error.png' />"),$("#duration").val(duration+addDays),checkDuration()):a.isBefore(d)&&("Morning"==b&&"Morning"==c&&($("#spnDayOff").html("<img src='"+baseURL+"assets/images/leave_2d_MM.png' />"),addDays=.5),"Afternoon"==b&&"Afternoon"==c&&($("#spnDayOff").html("<img src='"+baseURL+"assets/images/leave_2d_AA.png' />"),
addDays=.5),"Morning"==b&&"Afternoon"==c&&($("#spnDayOff").html("<img src='"+baseURL+"assets/images/leave_2d_MA.png' />"),addDays=1),"Afternoon"==b&&"Morning"==c&&($("#spnDayOff").html("<img src='"+baseURL+"assets/images/leave_2d_AM.png' />"),addDays=0),a.isSame(last_startDate)&&d.isSame(last_endDate)?($("#duration").val(duration+addDays),checkDuration()):$.ajax({type:"POST",url:baseURL+"leaves/length",data:{user_id:userId,start:$("#startdate").val(),end:$("#enddate").val()}}).done(function(a){duration=
parseFloat(a);$("#duration").val(duration+addDays);checkDuration()}),last_startDate=a,last_endDate=d))}
function checkDuration(){duration==last_duration&&last_type==$("#type option:selected").val()||""==$("#duration").val()||$.ajax({type:"POST",url:baseURL+"leaves/credit",data:{id:userId,type:$("#type option:selected").text()}}).done(function(a){a=parseInt(a);parseFloat($("#duration").val())>a?$("#lblCreditAlert").show():$("#lblCreditAlert").hide()});last_duration=duration;last_type=$("#type option:selected").val()}
$(function(){$("#viz_startdate").datepicker({changeMonth:!0,changeYear:!0,altFormat:"yy-mm-dd",altField:"#startdate",numberOfMonths:1,onClose:function(a){$("#viz_enddate").datepicker("option","minDate",a)}},$.datepicker.regional[languageCode]);$("#viz_enddate").datepicker({changeMonth:!0,changeYear:!0,altFormat:"yy-mm-dd",altField:"#enddate",numberOfMonths:1,onClose:function(a){$("#viz_startdate").datepicker("option","maxDate",a)}},$.datepicker.regional[languageCode]);$("#days").keyup(function(){var a=
$("#days").val(),a=a.replace(",",".");$("#days").val(a)});$("#viz_startdate").change(function(){getLeaveLength()});$("#viz_enddate").change(function(){getLeaveLength()});$("#startdatetype").change(function(){getLeaveLength()});$("#enddatetype").change(function(){getLeaveLength()});$("#type").change(function(){checkDuration()});$("#duration").keyup(function(){checkDuration()})});